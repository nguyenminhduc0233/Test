import java.sql.*;

public class SQLServerConnection {

    // Thông tin kết nối
    private static final String SERVER_NAME = "DESKTOP-B9AHTAF\\MINHDUC";  // Tên máy chủ
    private static final String PORT = "1433";  // Cổng mặc định cho SQL Server
    private static final String DATABASE_NAME = "YourDatabase";  // Tên cơ sở dữ liệu
    private static final String USERNAME = "your_username";  // Tên người dùng SQL Server
    private static final String PASSWORD = "your_password";  // Mật khẩu SQL Server

    // Chuỗi kết nối
    private static final String URL = "jdbc:sqlserver://" + SERVER_NAME + ":" + PORT + ";databaseName=" + DATABASE_NAME + ";user=" + USERNAME + ";password=" + PASSWORD;

    // Kết nối đến cơ sở dữ liệu
    public static Connection connect() throws SQLException {
        Connection conn = DriverManager.getConnection(URL);
        System.out.println("Kết nối thành công!");
        return conn;
    }

    // Hàm thực thi câu truy vấn SELECT và trả về kết quả
    public static ResultSet executeSelectQuery(String query) {
        try (Connection conn = connect(); Statement stmt = conn.createStatement()) {
            return stmt.executeQuery(query);
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return null;
    }

    // Hàm thực thi câu truy vấn UPDATE, INSERT, DELETE
    public static int executeUpdateQuery(String query) {
        try (Connection conn = connect(); Statement stmt = conn.createStatement()) {
            return stmt.executeUpdate(query);
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return -1;
    }

    // Hàm đóng kết nối
    public static void closeConnection(Connection conn) {
        try {
            if (conn != null && !conn.isClosed()) {
                conn.close();
                System.out.println("Đã đóng kết nối!");
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    // Main để kiểm tra kết nối và thực thi các câu truy vấn
    public static void main(String[] args) {
        // Ví dụ sử dụng hàm thực thi SELECT
        String selectQuery = "SELECT * FROM YourTable";
        try (ResultSet rs = executeSelectQuery(selectQuery)) {
            while (rs != null && rs.next()) {
                System.out.println("Dữ liệu: " + rs.getString("column_name"));
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }

        // Ví dụ sử dụng hàm thực thi UPDATE/INSERT/DELETE
        String updateQuery = "UPDATE YourTable SET column_name = 'new_value' WHERE condition";
        int rowsAffected = executeUpdateQuery(updateQuery);
        System.out.println("Số hàng bị ảnh hưởng: " + rowsAffected);
    }
}
